# 内存管理和垃圾回收机制

## 内存生命周期

不管什么程序语言，内存生命周期基本是一致的：

* 分配你所需要的内存
* 使用分配到的内存（读、写）
* 不需要时将其释放\归还

  `所有语言第二部分都是明确的。第一和第三部分在底层语言中是明确的，但在像JavaScript这些高级语言中，大部分都是隐含的`

## 内存空间

分为栈，堆，池，队列

* 栈 - 存放变量，基本类型数据,指向复杂类型数据的引用指针
* 堆 - 存放复杂类型数据
* 池又称为常量池 - 存放常量
* 队列在任务队列也会使用

## 垃圾回收

> 引用计数垃圾收集

这是最初级的垃圾收集算法。此算法把“对象是否不再需要”简化定义为“对象有没有其他对象引用到它”。如果没有引用指向该对象（零引用），对象将被垃圾回收机制回收

* 限制：循环引用

> 标记-清除算法

把“对象是否不再需要”简化定义为“对象是否可以获得”

从根部出发看是否能达到某个对象，如果能达到则认定这个对象还被需要，如果无法达到，则释放它

* 限制: 那些无法从根对象查询到的对象都将被清除

## 如何避免内存泄漏

> 全局变量

* 尽可能少的去创建全局变量
  * 直接声明的全局变量
  * 函数中 this 可能创建的全局变量

  如果必须使用全局变量存储数据时，确保用完以后把它设置为 null 或者重新定义

* 被遗忘的定时器或回调函数
  * 计时器停止才会被回收
  * 对象观察者
* 闭包
* DOM的引用
